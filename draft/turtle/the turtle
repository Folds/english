\ The portions of this file that are from CAL-4700
\ are copyright 2017 by the Osmosian Order.
\ The remainder is copyright 2017 by Jasper Paulsen.

\ The "keeper" file has routines that use the context,
\ but leave the context in the same state they found it,
\ and do not refresh the screen.

\ The "modder" file has routines that change the context.
\ ***

to add a line to a figure:
  if the figure is nil,
    create the figure;
    append the figure to the figures.
  add the line's start to the figure.
  add the line's end to the figure.

to add a name to some choices:
  allocate memory for a choice.
  put the name into the choice's name.
  put the choice at the end of the choices.

to add a spot to a figure:
  append the spot to the figure.

to change a hue by some points:
  add the points to the hue.

a choice is a thing with a name and a box.

the choices are some choices.

the context is a context.

a context is a thing with
  a spot, a box, a heading, a letter height,
  a color, a number, a pen size,
  a letter size at the letter height,
  a pen at the color,
  and a pen width at the pen size.

the context stack is some contexts.

to convert a heading to a trig angle:
  privatize the heading.
  normalize the heading.
  put the heading / 3840 in a ratio.
  multiply the ratio by 360.
  negate the ratio.
  add 450 / 1 to the ratio.
  convert the ratio to a mixio.
  normalize the mixio.
  if the mixio is at least 360,
    subtract 360 from the mixio.
  put the mixio's whole number in a number called degrees.
  put 0 in the mixio's whole number.
  multiply the mixio by 60.
  put the mixio's whole number in a number called minutes.
  put 0 in the mixio's whole number.
  multiply the mixio by 60.
  put the mixio's whole number in a number called seconds.
  put 0 in the mixio's whole number.
  convert the mixio to another ratio.
  put 100 in a number called hundredths.
  scale the hundredths given the other ratio.
  make the trig angle given the degrees and the minutes and the seconds and the hundredths.

to decide if a choice is a string:
  if the choice is nil, say no.
  if the choice's name is the string, say yes.
  say no.

to decide if the user is clicking in some choices;
to decide if the user has clicked in some choices;
to decide if the user clicked in some choices;
to decide if the user clicks in some choices;
to decide if the user is clicking on some choices;
to decide if the user has clicked on some choices;
to decide if the user clicked on some choices;
to decide if the user clicks on some choices:
  if the mouse's left button is not down, say no.
  find a choice given the mouse's spot.
  if the choice can't be found, say no.
  say yes.

to decide if you feel like it:
  pick a number between 1 and 100.
  if the number is less than 51, say yes.
  say no.

to draw a figure with a color:
  draw the figure with the color and the clear color.

some extra points are some points.

a figure is a polygon.
a circle is a  figure.
a cube is a figure.
a decagon is a figure. \ 10 sides
a desert landscape is a thing.
a diamond is a figure.
a fancy arrow is a figure.
a five pointed star is a figure.
a fractal forest is a thing.
a half circle flower is a figure.
a half circle is a figure.
a half leaf is a figure.
a heptagon is a figure. \ 7 sides
a hexagon is a figure.
a joke is a thing.
a koch curve is a figure.
a leaf is a figure.
a left crescent is a figure.
a nonagon is a figure. \ 9 sides
a pentagon is a figure.
a quarter circle is a figure.
a rectangle is a figure.
a right crescent is a figure.
a six pointed star is a figure.
a skinny rectangle is a rectangle.
a solid is a figure.
a spiral is a figure.
a star is a thing.
a tree is a figure.
a triangle is a figure.
a twelve-sided figure is a figure.
a yew tree is a figure.
an arc is a  figure.
an octagon is a figure.

the figures are some polygons.

to find a choice given a spot:
  start with nothing in the choice.
  loop.
    get the [first/next] choice from the choices.
    if the choice is missing, exit.
    if the spot is in the choice's box, break.
  repeat.

a geometric figure is a figure.

to get a rise and a run given a heading: \ see Madhava's Numbers
  convert the heading to a trig angle.
  put the rise denominator in the rise.
  scale the rise given the trig angle's sine.
  negate the rise. \ screen coordinates increase going down, not up.
  put the rise denominator in the run.
  scale the run given the trig angle's cosine.

a heading is some points.  \ [0-3839, clockwise from up or north]

to imagine a figure using a string and a spot;
to make a figure using a string and a spot;
to create a figure using a string and a center spot:
  create the figure.
  append the figure to the figures.
  privatize the string.
  lowercase the string.
  slap a substring on the string.
  loop.
  skip any leading noise in the substring.
  if the substring's length is less than 2, exit.
  put the substring's first's target into a byte.
  put the byte minus the little-a byte into a spot's y.
  add 1 to the substring's first.
  put the substring's first's target into the byte.
  put the byte minus the little-a byte into the spot's x.
  multiply the spot by 1/4 inch.
  add the center spot's x minus 3-1/8 inches plus 1 pixel to the spot's x.
  add the center spot's y minus 3-1/8 inches plus 1 pixel to the spot's y.
  append the spot to the figure.
  add 1 to the substring's first.
  repeat.

to lighten a hue by some points:
  convert the hue to some other points.
  add the points to the other points.
  convert the other points to the hue.
\
\to lighten a hue by some degrees:
\  add the degrees to the hue.

to list some choices in a box with a color;
to draw some choices in a box with a color:
  put the color into the context's color.
  draw the choices in the box.

to move a box close to the left side of another box;
to move a box close to the left of another box:
  move the box to the left of the other box.
  pick a length between 0 and the box's width times 3/4.
  move the box right the length.

to pick a hue between a number and another number:
  pick a number called result between the number and the other number.
  put the result in the hue.

to pick a letter of the alphabet:  \ put letter into context? ***
  pick a number between 65 and 90.
  put the number into the letter.

to pick a spot anywhere in the top half of a box;
to pick a spot in the top half of a box:
  privatize the box.
  put the box's center's y into the box's bottom.
  pick the spot in the box.

to pick a spot anywhere on a horizontal line;
to pick a spot on a horizontal line:
  pick the spot's x between the horizontal line's start's x and the horizontal line's end's x.
  put the horizontal line's y into the spot's y.

to pick a spot in a box about some twips above the middle;
to pick a spot in a box about some twips above the center:
  put the box into a bounding box.
  put the twips divided by 2 into some other twips.
  put the box's center's y minus the other twips into the bounding box's bottom.
  put the bounding box's bottom minus the twips into the bounding box's top.
  pick the spot anywhere in the bounding box.

to pick a spot in a box about some twips below the middle;
to pick a spot in a box about some twips below the center:
  put the box into a bounding box.
  put the twips divided by 2 into some other twips.
  put the box's center's y plus the other twips into the bounding box's top.
  put the bounding box's top plus the twips into the bounding box's bottom.
  pick the spot anywhere in the bounding box.

the pizza pie is a ratio equal to 45239/14400.
\ error is 8,526 trifles = 8,526 / (43,200 * 43,200)
\ deliberately changed from 355/113.

a point is a number [0 to 3839; for dividing a circle into compass points; 0 is noon; 960 points per quarter].
\
\to convert some points to some precise degrees:
\  put the points times 3840 divided by 3600 into the precise degrees.
\
\to convert some precise degrees to some points:
\  put the precise degrees times 3600 divided by 3840 into the points.

to put a box some twips by some other twips in the center of another box;
to center a box some twips by some other twips in another box:
  make the box the twips by the other twips.
  center the box in the other box.

to put masking tape below a figure:
  if the figure is nil, exit.
  if the figure's vertices' count is less than 2, exit.
  copy the figure to another figure.
  put the screen's bottom into a spot's y.
  put the figure's last's x into the spot's x.
  append the spot to the other figure.
  put the figure's first's x into the spot's x.
  append the spot to the other figure.
  append the figure's first's spot to the other figure.
  mask inside the other figure.
  destroy the other figure.

a rise is a number.
a run is a number.
the rise denominator is a number equal to 10000.

to shrink a box by some twips;
to indent a box some twips;
to indent a box by some twips;
to indent a box some twips on every side;
to indent a box given some twips:
  add the twips to the box's left.
  add the twips to the box's top.
  subtract the twips from the box's right.
  subtract the twips from the box's bottom.

a side is 1 unit.

a square is 1440 units.
\ arbitrary number high enough for precision divides

the square size is some twips.

the squirt o' two is a ratio equal to 61094/43200.
\ error is about 1,119 trifles = 1,119 / (43,200 * 43,200)

to take off all the masking tape: unmask everything.

to take off any masking tape: unmask everything.

to wait for a key to come back up:
  if the key is not up, repeat.

to wait for a key to come up:
  if the key is not up, repeat.

to wait for a key to go down:
  if the key is not down, repeat.

to wait on that there key with the esc on it:
  wait for the escape key.

to wait until we hit a key;
to wait for a key:
  wait for the key to go down.
  wait for the key to come up.
  flush all events.

to write a string in the middle of the screen:
  stroke the string in the middle of the screen's box.
  refresh the screen.

the zero line is a line. \ tracer
